generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model NotificationLog {
  id        Int      @id @default(autoincrement())
  type      String   @db.Text
  value     String   @db.Text
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model StravaActivity {
  id                   Int      @id @default(autoincrement())
  stravaId             String   @unique
  name                 String
  type                 String
  startDate            DateTime
  startDateLocal       DateTime
  distance             Decimal  @db.Decimal(8, 2)
  movingTime           Int
  locationCountry      String?
  distanceInKilometers Decimal  @db.Decimal(8, 2)
  formattedMovingTime  String
  kilometersPerHour    Decimal  @db.Decimal(8, 2)
  minutesPerKilometer  Decimal  @db.Decimal(8, 2)
  totalElevationGain   Decimal  @db.Decimal(8, 2)
  kudosCount           Int
  averageSpeed         Decimal  @db.Decimal(8, 2)
  maxSpeed             Decimal  @db.Decimal(8, 2)
  hasHeartRate         Boolean  @default(false)
  averageHeartRate     Decimal? @db.Decimal(8, 2)
  maxHeartRate         Decimal? @db.Decimal(8, 2)
  sufferScore          Decimal? @db.Decimal(8, 2)
  calories             Decimal  @db.Decimal(8, 2)
  createdAt            DateTime @default(now())
  updatedAt            DateTime @default(now())

  personalBests StravaPersonalBest[]
  gear          StravaGear?          @relation(fields: [stravaGearId], references: [id])
  stravaGearId  Int?

  @@index([stravaGearId])
}

model StravaPersonalBest {
  id                   Int            @id @default(autoincrement())
  name                 String
  distance             Decimal        @db.Decimal(8, 2)
  distanceInKilometers Decimal        @db.Decimal(8, 2)
  movingTime           Int
  formattedMovingTime  String
  stravaActivity       StravaActivity @relation(fields: [stravaActivityId], references: [id])
  stravaActivityId     Int

  @@index([stravaActivityId])
}

model StravaGear {
  id             Int              @id @default(autoincrement())
  stravaGearId   String           @unique
  primary        Boolean          @default(false)
  name           String
  resourceState  Int
  retired        Boolean          @default(false)
  distance       Decimal          @db.Decimal(8, 2)
  stravaActivity StravaActivity[]
}

model Post {
  slug  String @id @db.VarChar(255)
  views Int    @default(1)
}
